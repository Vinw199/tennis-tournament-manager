## Progress Log — 2025-08-20

### Summary
- Simplified the Wizard (removed autosave), clarified draft lifecycle, and fixed draft hydration.
- Cleaned up public views: Live page improved; completed events now use a dedicated recap route; Live auto-redirects when completed.
- UI polish: consistent date formatting, better bracket connectors, and clearer admin/read-only affordances.
- Fixed public access for Live via RLS policies for active events.

### Key Changes
- Wizard
  - Removed autosave; added explicit persistence on step changes and via Exit dialog (Save & Exit or Discard & Exit).
  - Added loading states while hydrating draft and roster.
  - Draft lifecycle: “Start New Tournament” prompts, deletes existing draft, then starts fresh.
  - Step 2 improvements: “Select all” / “Clear all” and an “X/Y selected” counter.

- Dashboard
  - Header shows “Continue draft” and “Start New Tournament” when a draft exists; otherwise “Create New Tournament”.

- Past Events & Recap
  - List uses formatted dates (e.g., Jan 5, 2025).
  - Links now go to recap: `/past-events/[tournamentId]` (read-only, no admin controls, no live actions).

- Live Page
  - Shows tournament name and formatted date.
  - Hides admin link for non-admins.
  - Displays Semis/Final bracket when present.
  - If tournament is completed, automatically redirects to the recap page.

- Manage Page
  - Removed display of internal tournament ID; kept “Share Live Link”, Generate Semis/Final, and Complete.

- Bracket UI
  - Connector lines now converge at the center-left of the Final card for symmetry.

- Auth & RLS
  - Middleware allows unauthenticated access to `/t/[id]/live`.
  - Added public read RLS policies for active `tournaments`, `entries`, and `matches` (see migration).

### Files Touched (high-level)
- Wizard
  - `app/(wizard)/tournaments/new/layout.jsx` — single header with “Exit Draft”; removed duplicate buttons.
  - `app/(wizard)/tournaments/new/page.jsx` — simplified save flow, explicit saves on step change, exit dialog, loading states, select all/clear all.
  - `data/wizardDraft.client.js` — stable get/upsert with `updated_at`; clear draft helper.
  - `components/StartNewTournamentButton.jsx` — confirm, delete draft, open wizard.

- Public Views
  - `app/t/[tournamentId]/live/page.js` — name/date header, admin link gating, bracket, completed redirect.
  - `app/(with-sidebar)/past-events/page.js` — formatted dates, link to recap.
  - `app/(with-sidebar)/past-events/[tournamentId]/page.js` — recap view with groups + bracket; no live actions.

- Manage & UI
  - `app/(with-sidebar)/t/[tournamentId]/manage/page.jsx` — hide internal ID.
  - `components/bracket/Bracket.jsx` — connector symmetry.
  - `app/(with-sidebar)/page.js` — header buttons and date formatting.

- Auth/RLS
  - `utils/supabase/middleware.js` — allow `/t/[id]/live` for unauthenticated users.
  - `supabase/migrations/20250820120000_allow_public_live_select.sql` — public select for active tournaments, entries, matches.

### Next Steps
- Optional: confirm dialog UI for “Complete Tournament”.
- Optional: unit tests for domain logic (entries, seeding, round-robin, standings).
- Optional: badges on Manage/Live for phase progression.


